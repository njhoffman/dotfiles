# Change prefix key to Ctrl+a
unbind C-b
set -g prefix C-a

# nested sessions
bind-key -n C-t send-prefix

# default 256 colors
set -g default-terminal "xterm-256color"
set-option -ga terminal-overrides ",xterm-256color:Tc"
set -g default-terminal "screen-256color"
set-option -ga terminal-overrides ",screen-256color:Tc"

# term fixes
setw -g xterm-keys on
set -q -g status-utf8 on
setw -q -g utf8 on

# Last active window
unbind l
bind C-p last-window

# Copy/Paste mode, make more like vim
### to copy and paste Ctrl-a-[ ... make selection ... Ctrl-a-]
unbind [
bind Escape copy-mode
unbind p
bind p paste-buffer
# todo: what replaced these?
# bind-key -Tcopy-mode-vi 'v' send -X begin-selection
# bind-key -Tcopy-mode-vi 'y' send -X copy-selection

# Faster key repeitition
set -s escape-time 100

# Use Vi mode
setw -g mode-keys vi

# mouse settings
set -g mouse on

# make mousewheel work when not in copy mode
bind-key -T root WheelUpPane if-shell -F -t = "#{alternate_on}" "send-keys -M" "select-pane -t =; copy-mode -e; send-keys -M"
bind-key -T root WheelDownPane if-shell -F -t = "#{alternate_on}" "send-keys -M" "select-pane -t =; send-keys -M"

# key bindings for splitting
unbind %
bind h split-window -hc '#{pane_current_path}'
unbind '"'
bind v split-window -vc '#{pane_current_path}'
bind -n C-S-Down resize-pane -y 40
bind -n C-S-Up resize-pane -y 120

# History
set -g history-limit 100000

# Terminal emulator window title
set -g set-titles on
set -g set-titles-string '#S:#I.#P #W'

# allow shared sessions to size differently
setw -g aggressive-resize on

# rotate pane with panes in next window
bind-key -n C-n swap-pane -s :+.top \; rotate-window -Ut :+
bind-key -n C-S-n swap-pane -s :+.bottom \;  rotate-window -Dt :+

# Highlighting the active window by border
set -g pane-active-border-bg colour025
set -g pane-active-border-fg colour159

# window options
setw -g automatic-rename

bind-key R source-file ~/.tmux.conf \; \
	display-message "source-file done"

# window switching
unbind n
bind = next-window
bind - previous-window
bind -n C-Space next-window
bind -n C-Right next-window
bind -n C-Left previous-window


# colon :
bind : command-prompt

# resize panes with mouse (drag borders)
bind -n C-h select-pane -L
bind -n C-l select-pane -R
bind -n C-j select-pane -U
bind -n C-k select-pane -D

# messaging
set -g message-fg colour235
set -g message-bg colour166
set -g message-command-fg blue
set -g message-command-bg black

#--Status-Bar-------------------------------------------------------------------
## Default colors
set -g status-bg "#002222"
set -g status-fg white

# status bar on top
# set-option -g status-position top
set-option -g status-position bottom

set -g status-interval 5

# Center align window list
set -g status-justify centre

# Left side of status bar
# set-option -g status-left "#[fg=green][#[fg=cyan]#S#[fg=cyan]:#(whoami)@#H #(curl icanhazip.com)#[fg=green]] [#[fg=white]#(ip a | grep 'eth0' | grep 'inet' | awk 'BEGIN {FS=\" +\"}{print \"eth0 \" $3}')#[fg=green]]"
set-option -g status-left "#[fg=green][#[fg=cyan]#S#[fg=cyan]:#(whoami)@#H#[fg=green]] [#[fg=white]#(ip a | grep 'eth0' | grep 'inet' | awk 'BEGIN {FS=\" +\"}{print \"eth0 \" $3}')#[fg=green]]"
set-option -g status-left-length 100

# Inactive windows in status bar
set-window-option -g window-status-format '#[bg=#33333,fg=cyan,dim]#I#[fg=cyan,dim]:#[fg=white]#W#F'

# Current or active window in status bar
set-window-option -g window-status-current-format '#[bg=#3333CC,fg=cyan] #I#[fg=white]:#[fg=#ffffff]#W#[fg=white]#F '

set-option -g set-titles on

# Alerted window in status bar. Windows which have an alert (bell, activity or content).
set-option -g window-status-activity-style 'fg=#FF8000,bg=#333333'
set-option -g window-status-current-style 'fg=#FFFFFF,bg=#333333'
set-option -g window-status-bell-style 'fg=red,bold,blink,bg=#333333'
set-option -g window-status-last-style "bg=#333333"

# Right side of status bar
set -g status-right '#[fg=green][#[fg=cyan]%Y-%m-%d #[fg=white]%H:%M#[default]#[fg=green]]'
set -g status-right-length 80

# loud or quiet?
set-option -g visual-activity on
set-option -g visual-bell off
set-option -g visual-silence on
set-window-option -g monitor-activity on
#set-option -g bell-action none

# tmux clock
set -g clock-mode-colour blue

# some key-binding changes
bind x kill-pane
bind X next-layout
bind Z previous-layout

#if-shell '[ $(echo "$(tmux -V | cut -d" " -f2) >= 2.1" | bc) -eq 1 ]' \
    'command if true' \
    'command if false'
# if-shell '[ $(echo "$(tmux -V | cut -d" " -f2) >= 2.1" | bc) -eq 1 ]' \
    'set -g mouse on; set -g mouse-utf8 on' \
    'set -g mode-mouse on; set -g mouse-resize-pane on; set -g mouse-select-pane on; set -g mouse-select-window on'
